# **MALICIOUS VBA WRITEUP**

The file provided is vba file which contains obfuscated codes in it. This file can be runned through olevba so that source code in clear text and security-related patterns can be detected.

`olevba invoice.vb`

![1](https://user-images.githubusercontent.com/67140773/185426169-2bca389e-0279-4665-be04-c05fa4128d59.png)

![olevba](https://user-images.githubusercontent.com/67140773/185424549-15fe9dcc-249f-4f16-acd6-26e2f2c14b60.png)

The summary above gives some high level of idea but still is not clear. 

Viper monkey is another good tool that can be used. Before using it, the source code needs to be modified as it can show some parsing errors because it contains other things except code.

![0](https://user-images.githubusercontent.com/67140773/185432403-86a866b5-f00f-4388-a344-47d06f5481ca.png)

![0](https://user-images.githubusercontent.com/67140773/185433431-424e6977-d0c3-4ce2-bfb5-9919647c7479.png)


So, the file was opened using a text editor and the part as shown above were removed and only the code part were kept.

Now, the file can be runned through vipher monkey.

`vmonkey -c invoice.vb`

![1](https://user-images.githubusercontent.com/67140773/185428091-70acd5b0-7a84-4510-bff6-b4ce45a26e3a.png)

![vipermonkey](https://user-images.githubusercontent.com/67140773/185428142-76f2fac3-43ee-475c-a275-de5703f45b89.png)

Now it provides very interesting information in good format. This should give all the answer about the challege.

### **Question 1: The document initiates the download of a payload after the execution, can you tell what website is hosting it?**
![1](https://user-images.githubusercontent.com/67140773/185430096-bf5bc4aa-9a9d-40b1-9aee-493a16471122.png)


### **Question 2: What is the filename of the payload (include the extension)?**
![2](https://user-images.githubusercontent.com/67140773/185430105-8ffbb1f4-5ad2-4f0d-8350-897f100a3356.png)


### **Question 3: What method is it using to establish an HTTP connection between files on the malicious web server?**
![3](https://user-images.githubusercontent.com/67140773/185430110-dceaeb46-f9fb-4cd4-97e2-49e0c5245119.png)


### **What user-agent string is it using?**
![4](https://user-images.githubusercontent.com/67140773/185430113-c091dfcc-26f3-43ef-8db5-499ff41bf761.png)


### **What object does the attacker use to be able to read or write text and binary files?**
![5](https://user-images.githubusercontent.com/67140773/185430117-5b80c343-481a-47d4-bcf9-b98bb73d91e0.png)


### **What is the object the attacker uses for WMI execution? Possibly they are using this to hide the suspicious application running in the background.**
![6](https://user-images.githubusercontent.com/67140773/185430119-92cea8b8-88b4-4a77-992f-118b7132ae13.png)
